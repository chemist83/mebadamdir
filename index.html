<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Quantum Orbital Models</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Courier New', monospace; }
        #ui { position: absolute; top: 20px; left: 20px; color: #00ff00; background: rgba(0,20,0,0.9); padding: 20px; border: 1px solid #00ff00; border-radius: 5px; width: 280px; }
        input { width: 100%; cursor: pointer; accent-color: #00ff00; }
        .legend { font-size: 0.8em; margin-top: 10px; line-height: 1.5; }
    </style>
</head>
<body>

<div id="ui">
    <div style="font-weight: bold; font-size: 1.2em;">ATOM CONFIGURATOR</div>
    <div id="elName" style="font-size: 1.5em; color: white; margin: 10px 0;">Hydrogen (1)</div>
    <input type="range" id="selector" min="1" max="10" value="1">
    
    <div class="legend">
        <span style="color:cyan">●</span> 1s Orbital (Inner Core)<br>
        <span style="color:magenta">●</span> 2s Orbital (Valence Sphere)<br>
        <span style="color:yellow">●</span> 2p Orbitals (Dumbbells)
    </div>
    <div id="stats" style="margin-top:10px; color: #888;">Electrons: 1</div>
</div>

<script type="importmap">
    { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
</script>

<script type="module">
    import * as THREE from 'three';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(4, 4, 8);
    camera.lookAt(0,0,0);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const names = ["Hydrogen", "Helium", "Lithium", "Beryllium", "Boron", "Carbon", "Nitrogen", "Oxygen", "Fluorine", "Neon"];
    let atomGroup = new THREE.Group();
    scene.add(atomGroup);

    // Function to build the probability cloud geometry
    function createCloud(type, count, color, radius, axis = 'y') {
        const points = [];
        const density = 3000 * count;

        for (let i = 0; i < density; i++) {
            let r = Math.abs(standardNormal());
            let theta = Math.random() * Math.PI * 2;
            let phi = Math.acos(2 * Math.random() - 1);

            let x, y, z;
            if (type === 's') {
                r *= radius;
                x = r * Math.sin(phi) * Math.cos(theta);
                y = r * Math.sin(phi) * Math.sin(theta);
                z = r * Math.cos(phi);
            } else {
                // p-orbital dumbbell logic
                r *= 3.5;
                const pPhi = Math.acos(Math.pow(Math.random() * 2 - 1, 3));
                x = r * Math.sin(pPhi) * Math.cos(theta);
                y = r * Math.cos(pPhi);
                z = r * Math.sin(pPhi) * Math.sin(theta);
                
                // Align to axis
                if(axis === 'x') { [x, y] = [y, x]; }
                else if(axis === 'z') { [z, y] = [y, z]; }
            }
            points.push(new THREE.Vector3(x, y, z));
        }

        const geo = new THREE.BufferGeometry().setFromPoints(points);
        const mat = new THREE.PointsMaterial({ color: color, size: 0.02, transparent: true, opacity: 0.5, blending: THREE.AdditiveBlending });
        return new THREE.Points(geo, mat);
    }

    function buildAtom(z) {
        while(atomGroup.children.length > 0) atomGroup.remove(atomGroup.children[0]);
        
        // 1. Add Nucleus
        const nuc = new THREE.Mesh(new THREE.SphereGeometry(0.15, 8, 8), new THREE.MeshBasicMaterial({color: 0xffffff}));
        atomGroup.add(nuc);

        // 2. Build 1s (All 10 have this)
        atomGroup.add(createCloud('s', (z == 1 ? 1 : 2), 0x00ffff, 0.8));

        // 3. Build 2s (Elements 3-10)
        if (z >= 3) {
            atomGroup.add(createCloud('s', (z == 3 ? 1 : 2), 0xff00ff, 1.8));
        }

        // 4. Build 2p (Elements 5-10)
        if (z >= 5) {
            const pElectrons = z - 4;
            if (pElectrons >= 1) atomGroup.add(createCloud('p', 1, 0xffff00, 1, 'x'));
            if (pElectrons >= 3) atomGroup.add(createCloud('p', 1, 0xffff00, 1, 'y'));
            if (pElectrons >= 5) atomGroup.add(createCloud('p', 1, 0xffff00, 1, 'z'));
        }

        document.getElementById('elName').innerText = `${names[z-1]} (${z})`;
        document.getElementById('stats').innerText = `Electrons: ${z} | Protons: ${z}`;
    }

    function standardNormal() {
        return Math.sqrt(-2 * Math.log(Math.random())) * Math.cos(2 * Math.PI * Math.random());
    }

    document.getElementById('selector').oninput = (e) => buildAtom(parseInt(e.target.value));
    buildAtom(1);

    function animate() {
        requestAnimationFrame(animate);
        atomGroup.rotation.y += 0.005;
        atomGroup.rotation.x += 0.002;
        renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
</body>
</html>
